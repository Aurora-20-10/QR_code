<!DOCTYPE html><html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tr·∫°m QR c·ªßa Aurora.T-05</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #121212;
      color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
    }
    h1 {
      color: #80d0ff;
      text-shadow: 0 0 5px #00f0ff;
    }
    input, button, select, textarea {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
    }
    #qr-list {
      margin-top: 20px;
    }
    .qr-item {
      background: #1e1e1e;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
      box-shadow: 0 0 10px #000;
    }
    canvas {
      display: block;
      margin: 10px 0;
    }
    .stats {
      margin-top: 20px;
      font-style: italic;
      color: #a0a0a0;
    }
  </style>
</head>
<body>
  <h1>üß¨ Aurora QR Station ‚Äì T·∫ßng 5 ‚Äì L·ªõp 2: Chi·∫øn l∆∞·ª£c s·ªëng</h1>
  <input id="qr-input" placeholder="N·ªôi dung QR" style="width: 300px">
  <input id="qr-note" placeholder="Ghi ch√∫ (tu·ª≥ ch·ªçn)" style="width: 200px">
  <select id="qr-tag">
    <option value="Ch∆∞a ph√¢n lo·∫°i">Ch∆∞a ph√¢n lo·∫°i</option>
    <option value="C√° nh√¢n">C√° nh√¢n</option>
    <option value="C√¥ng vi·ªác">C√¥ng vi·ªác</option>
    <option value="H·ªá th·ªëng">H·ªá th·ªëng</option>
  </select>
  <select id="qr-mood">
    <option value="Tr·ªëng">T√¢m tr·∫°ng?</option>
    <option value="T·ªânh t√°o">T·ªânh t√°o</option>
    <option value="M·ªát m·ªèi">M·ªát m·ªèi</option>
    <option value="ƒê·ªông l·ª±c">ƒê·ªông l·ª±c</option>
    <option value="Ph√≤ng th·ªß">Ph√≤ng th·ªß</option>
    <option value="Giao chi·∫øn">Giao chi·∫øn</option>
  </select>
  <button onclick="createQR()">T·∫°o & L∆∞u</button>
  <button onclick="exportData()">üì§ Xu·∫•t d·ªØ li·ªáu</button>
  <input type="file" onchange="importData(event)">
  <div class="stats" id="stats"></div>
  <div id="qr-list"></div>  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>  <script>
    let storedQRs = JSON.parse(localStorage.getItem('aurora_qr_list')) || [];

    function saveToStorage() {
      localStorage.setItem('aurora_qr_list', JSON.stringify(storedQRs));
    }

    function createQR() {
      const text = document.getElementById("qr-input").value.trim();
      const note = document.getElementById("qr-note").value.trim();
      const tag = document.getElementById("qr-tag").value;
      const mood = document.getElementById("qr-mood").value;
      if (!text) return;

      storedQRs.unshift({ text, note, tag, mood, created: new Date().toISOString() });
      saveToStorage();
      renderQRs();

      document.getElementById("qr-input").value = "";
      document.getElementById("qr-note").value = "";
    }

    function deleteQR(index) {
      if (confirm("X√≥a m√£ QR n√†y?")) {
        storedQRs.splice(index, 1);
        saveToStorage();
        renderQRs();
      }
    }

    function exportData() {
      const blob = new Blob([JSON.stringify(storedQRs, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'aurora_qr_data.json';
      a.click();
    }

    function importData(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = JSON.parse(e.target.result);
          if (!Array.isArray(data)) throw new Error();
          const unique = data.filter(d => !storedQRs.some(q => q.text === d.text));
          storedQRs = [...unique, ...storedQRs];
          saveToStorage();
          renderQRs();
          alert("ƒê√£ nh·∫≠p " + unique.length + " m√£ QR m·ªõi.");
        } catch {
          alert("File kh√¥ng h·ª£p l·ªá ho·∫∑c sai ƒë·ªãnh d·∫°ng.");
        }
      };
      reader.readAsText(file);
    }

    function renderQRs() {
      const list = document.getElementById("qr-list");
      const stats = document.getElementById("stats");
      list.innerHTML = "";
      stats.innerText = `T·ªïng m√£ QR: ${storedQRs.length}`;

      storedQRs.forEach((qr, index) => {
        const div = document.createElement("div");
        div.className = "qr-item";

        const p = document.createElement("p");
        p.innerHTML = `üîó <strong>${qr.text}</strong><br>
                       üìù ${qr.note || 'Kh√¥ng ghi ch√∫'}<br>
                       üè∑Ô∏è ${qr.tag} ‚Äì üß† ${qr.mood || 'Kh√¥ng ghi'}<br>
                       üìÖ ${new Date(qr.created).toLocaleString()}`;

        const canvas = document.createElement("canvas");
        QRCode.toCanvas(canvas, qr.text, { width: 200 });

        const dlBtn = document.createElement("button");
        dlBtn.innerText = "üì• T·∫£i ·∫£nh QR";
        dlBtn.onclick = () => {
          const link = document.createElement("a");
          link.download = `qr_${index}.png`;
          link.href = canvas.toDataURL("image/png");
          link.click();
        };

        const delBtn = document.createElement("button");
        delBtn.innerText = "üóë X√≥a";
        delBtn.onclick = () => deleteQR(index);

        div.appendChild(p);
        div.appendChild(canvas);
        div.appendChild(dlBtn);
        div.appendChild(delBtn);
        list.appendChild(div);
      });
    }

    renderQRs();
  </script></body>
</html>
